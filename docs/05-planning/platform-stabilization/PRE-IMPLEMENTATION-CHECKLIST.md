# Pre-Implementation Checklist: Platform Stabilization

**Date:** 2026-01-26
**Epic:** Platform Stabilization (Phase 2.1-2.3)
**Stories:**
- 2.1: Fix build failure (OPENAI_API_KEY) - 1 DU
- 2.2: Fix Render worker env vars - 1 DU
- 2.3: Auth flow manual testing - 2 DU

---

## Gate 1: External Dependencies (BLOCKING)

### API Verification
- [ ] Supabase connection healthy
- [ ] AgentKit SDK loads without error
- [ ] Mem0 API accessible
- [ ] Redis connection established

### Auth/Permissions
- [ ] Supabase service role key valid
- [ ] OpenAI API key valid (runtime, not build-time)
- [ ] Unipile API key configured

### Rate Limits Documented
- [ ] OpenAI: _____ requests/min
- [ ] Supabase: _____ requests/sec
- [ ] Mem0: _____ requests/min

**Gate 1 Status:** [ ] PASS / [x] FAIL
**Blocker:** Redis unhealthy, Supabase schema mismatch

---

## Gate 2: Performance Baseline (BLOCKING)

### Current Metrics
| Metric | Value | Target |
|--------|-------|--------|
| Health check latency | 1322ms | <500ms |
| Supabase latency | 419ms | <200ms |
| Mem0 latency | 481ms | <300ms |
| Build time | 10.1s | <15s |
| Test execution | 11.3s | <30s |

### Benchmark Script
- [ ] Created `scripts/benchmark-platform.ts`
- [ ] Baseline measurements recorded
- [ ] Target metrics documented

**Gate 2 Status:** [ ] PASS / [x] FAIL
**Blocker:** No baseline script, Redis timeout

---

## Gate 3: Data Validation (Before Merge)

### TypeScript
- [ ] `npm run typecheck` passes
- [ ] No new type errors introduced

### Tests
- [ ] All 1252 existing tests pass
- [ ] 5 failing tests fixed OR documented
- [ ] New validation tests written for:
  - [ ] OpenAI dynamic import
  - [ ] Redis connection fallback
  - [ ] Auth flow integration

### Data Integrity
- [ ] No orphaned data references
- [ ] RLS policies verified

**Gate 3 Status:** [ ] PASS / [ ] FAIL
**Blocker:** 5 tests failing

---

## Gate 4: Acceptance Criteria (Before QA)

### Story 2.1: Fix Build Failure
- [ ] Build completes without OPENAI_API_KEY error
- [ ] All API routes compile
- [ ] Vercel deployment succeeds
- [ ] Health check shows AgentKit healthy

### Story 2.2: Fix Render Worker
- [ ] REDIS_URL configured in Render
- [ ] SUPABASE vars configured in Render
- [ ] Worker starts without errors
- [ ] Health check shows Redis healthy
- [ ] Background jobs process correctly

### Story 2.3: Auth Flow Testing
- [ ] Login works on RevOS (/dashboard)
- [ ] Login works on AudienceOS (/audienceos)
- [ ] SSO persists across apps
- [ ] Logout clears session for both apps
- [ ] Protected routes redirect correctly

**Gate 4 Status:** [ ] PASS / [ ] FAIL

---

## Definition of Done

For this epic to be DONE:
- [x] Risk assessment completed
- [ ] All 4 gates PASS
- [ ] Code merged to main
- [ ] Vercel deployment succeeds
- [ ] Health check shows all green
- [ ] `/docs/` updated
- [ ] Slack canvas updated
- [ ] Dashboard DUs logged

---

## Execution Timeline

| Task | Duration | Depends On |
|------|----------|------------|
| Fix OPENAI dynamic import | 30 min | None |
| Test build locally | 10 min | Above |
| Configure Render env vars | 15 min | None |
| Verify Redis connection | 10 min | Above |
| Auth flow testing | 1 hour | Build working |
| Update documentation | 30 min | All above |

**Total Estimated:** 2.5 hours (4 DUs)

---

## Sign-Off

| Role | Name | Date | Signature |
|------|------|------|-----------|
| Dev Lead | | | [ ] Approved |
| PM | Roderic | | [ ] Approved |

---

## GO/NO-GO Decision

| Gate | Status | Signed Off |
|------|--------|------------|
| Gate 1: Dependencies | [ ] PASS / [x] FAIL | |
| Gate 2: Baseline | [ ] PASS / [x] FAIL | |
| Gate 3: Validation | [ ] PASS / [ ] FAIL | |
| Gate 4: Criteria | [ ] PASS / [ ] FAIL | |

**Decision:** [ ] GO / [x] NO-GO - Address 3 HIGH blockers first

---

*Generated by Deputy - Pre-Implementation Verification Protocol*
